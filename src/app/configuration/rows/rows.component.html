<div class="p-8 flex flex-col flex-wrap justify-between h-full w-full">

    <div class="flex flex-col flex-wrap gap-y-8">

        <div class="flex flex-col flex-wrap gap-y-2">
            <h1 class="font-bold text-lg">FILTERS</h1>
            <div class="flex flex-col md:flex-row justify-between">
                <div>
                    Here you can filter out some rows of your data.
                    <mat-icon #tooltip="matTooltip" (click)="tooltip.toggle()" color="primary"
                    matTooltip="Decide your own criterias to filter your excel file. Only rows that matches all criterias will be displayed, please pay attention to insert the correct type. Regex are JAVA ones">
                    help</mat-icon>
                </div>
                <button mat-raised-button color="primary" (click)="addCriteria()">ADD FILTER</button>
            </div>
        </div>

        <div *ngIf="this.config.rowCriteria!.length > 0">

            <div class="max-h-[480px] overflow-y-auto p-[1px]">
                <table mat-table [dataSource]="this.config.rowCriteria!"
                    class="mat-elevation-z4 h-full w-full px-2 text-center">

                    <ng-container matColumnDef="Column">
                        <th mat-header-cell *matHeaderCellDef>Col Name</th>
                        <td mat-cell *matCellDef="let criteria index as i">
                            <div class="pt-[10px] flex flex-row items-center">
                                <span class="visible md:hidden basis-1/5 relative bottom-1">Col Name: </span>
                                <ng-select [items]="this.config.columns!" appearance="outline" [clearable]="false"
                                    class="w-full" appendTo="body" class="relative" dropdownPosition="auto"
                                    [virtualScroll]="true" [(ngModel)]="this.config.rowCriteria![i].columnName">
                                </ng-select>
                            </div>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="Type">
                        <th mat-header-cell *matHeaderCellDef>Type</th>
                        <td mat-cell *matCellDef="let criteria; index as i">
                            <div class="flex flex-row items-center">
                                <span class="visible md:hidden basis-1/5">Type: </span>
                                <mat-form-field appearance="outline" class="pt-4">
                                    <mat-select [(value)]="this.config.rowCriteria![i].type">
                                        <mat-option value="String">String</mat-option>
                                        <mat-option value="Number">Number</mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="Op">
                        <th mat-header-cell *matHeaderCellDef>Op</th>
                        <td mat-cell *matCellDef="let criteria; index as i">
                            <div class="flex flex-row items-center">
                                <span class="visible md:hidden basis-1/5">Op: </span>
                                <mat-form-field appearance="outline" class="pt-4">
                                    <mat-select [(value)]="this.config.rowCriteria![i].op">
                                        <mat-option value=">">></mat-option>
                                        <mat-option value="&lt;">&lt;</mat-option>
                                        <mat-option value="==">==</mat-option>
                                        <mat-option value="!=">!=</mat-option>
                                        <mat-option *ngIf="this.config.rowCriteria![i]?.type==='String'" value="Regex">
                                            Regex</mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="Value">
                        <th mat-header-cell *matHeaderCellDef>Value</th>
                        <td mat-cell *matCellDef="let criteria; index as i">
                            <div class="flex flex-row items-center">
                                <span class="visible md:hidden basis-1/5">Value: </span>
                                <mat-form-field appearance="outline" class="pt-4">
                                    <input matInput [(ngModel)]="this.config.rowCriteria![i].value">
                                </mat-form-field>
                            </div>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="Action">
                        <th mat-header-cell *matHeaderCellDef></th>
                        <td mat-cell *matCellDef="let criteria; index as i">
                            <div class="hidden md:block">
                                <button mat-mini-fab (click)="removeCriteria(i)">
                                    <mat-icon color="warn">delete</mat-icon>
                                </button>
                            </div>
                            <div class="flex md:hidden flex-row justify-center">
                                <button mat-raised-button color="accent" (click)="removeCriteria(i)" class="w-full">
                                    <mat-icon color="warn">delete</mat-icon>
                                </button>
                            </div>
                        </td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="['Column','Type', 'Op','Value', 'Action']"></tr>
                    <tr mat-row *matRowDef="let row; columns: ['Column','Type','Op','Value', 'Action'];"></tr>
                </table>
            </div>
        </div>
    </div>
    <div class="flex flex-row justify-end pt-4">
        <button mat-raised-button color="accent" (click)="indexTo.emit(4)">NEXT</button>
    </div>

</div>